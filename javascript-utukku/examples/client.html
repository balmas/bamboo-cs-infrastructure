<html>
  <head>
    <title>Testing Client/Server/Agent</title>
    <script src="jquery.js" type="text/javascript"></script>
    <script src="../lib/utukku.js" type="text/javascript"></script>
    <script src="../lib/engine.js" type="text/javascript"></script>
    <script src="../lib/client.js" type="text/javascript"></script>
    <script type="text/javascript">
      Utukku.Client.Connection.url = "ws://localhost:3000/demo";
      /* open a connection so we can settle */
      Utukku.Client.Connection({ });
    </script>
  </head>
  <body>
    <script type="text/javascript">
      var wait = function() {
        if(!Utukku.Engine.has_handler("http://www.example.com/echo/1.0#")) {
          document.write("<p>Waiting on handler creation</p>");
          setTimeout(wait, 1000);
        }
        else {
          document.write("<p>Initiating request to double 1..10</p>");
          Utukku.Client.Function({
            namespace: "http://www.example.com/echo/1.0#",
            name: "double",
            args: Utukku.Engine.ConstantRangeIterator(1,10),
            next: function(v) { document.write("<p>" + v + "</p>"); },
            done: function() { document.write("<p>done!</p>"); }
          });
        }
      };
      wait();
    </script>
  </body>
</html>
